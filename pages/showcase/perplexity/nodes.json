[
  {
    "meta": {
      "name": "Perplexity AI Chat",
      "icon": {
        "type": "URL",
        "url": "https://firebasestorage.googleapis.com/v0/b/website-a1s39m.appspot.com/o/buildship-app-logos%2Fperplexity.png?alt=media&token=c2b4b546-a17f-4866-8635-73377b79bca4"
      },
      "description": "Sends a question to Perplexity's AI models and generates a response for the given chat conversation.",
      "id": "perplexity-ai-chat"
    },
    "type": "script",
    "integrations": [],
    "dependencies": {},
    "group": [
      {
        "uid": "perplexity",
        "name": "Perplexity AI",
        "description": "Nodes to leverage Perplexity AI's blazingly fast LLM inference.",
        "id": "perplexity",
        "iconUrl": "https://firebasestorage.googleapis.com/v0/b/website-a1s39m.appspot.com/o/buildship-app-logos%2Fperplexity.png?alt=media&token=c2b4b546-a17f-4866-8635-73377b79bca4"
      }
    ],
    "category": ["Integrations"],
    "live": true,
    "deployToBucket": {
      "ranBy": "bhavya@rowy.io.rowy",
      "completedAt": { "_seconds": 1710243501, "_nanoseconds": 102000000 }
    },
    "groupInfo": "perplexity",
    "syncIndex": {
      "ranBy": "bhavya@rowy.io.rowy",
      "status": "synced",
      "completedAt": { "_seconds": 1713822693, "_nanoseconds": 784000000 }
    },
    "id": "perplexity-ai-chat",
    "_libRef": {
      "integrity": "v3:02add91f40bd3d93001bc0615e29c37a",
      "libNodeRefId": "@buildship/perplexity-ai-chat",
      "isDirty": false,
      "libType": "public",
      "src": "https://storage.googleapis.com/buildship-app-us-central1/publicLib/nodes/@buildship/perplexity-ai-chat/1.0.1/build.cjs",
      "version": "1.0.1"
    },
    "output": {
      "buildship": {},
      "description": "The response generated by the selected Perplexity AI Model",
      "title": "Model Response",
      "type": "array"
    },
    "_updatedBy": {
      "emailVerified": true,
      "photoURL": "https://lh3.googleusercontent.com/a/AAcHTteHR1mYhhB_mvgntLyHkZFTdhB-nqqb3xJiKW13sX6odg=s96-c",
      "uid": "HIGVNMhvkORk3bmp9wPorP5wsXT2",
      "displayName": "Bhavya Verma",
      "email": "bhavya@rowy.io.rowy",
      "timestamp": { "_seconds": 1717242934, "_nanoseconds": 830000000 }
    },
    "integrity": "v3:733a539274c3d8da996c656a88c9e192",
    "src": "https://storage.googleapis.com/buildship-app-us-central1/publicLib/nodes/@buildship/perplexity-ai-chat/1.1.1/build.cjs",
    "inputs": {
      "type": "object",
      "properties": {
        "models": {
          "buildship": {
            "options": [
              { "label": "Mistral 7B Instruct", "value": "mistral-7b-instruct" },
              { "label": "Mixtral 8X7B Instruct", "value": "mixtral-8x7b-instruct" },
              { "label": "Sonar Small Chat", "value": "sonar-small-chat" },
              { "label": "Sonar Medium Chat", "value": "sonar-medium-chat" },
              { "label": "Sonar Small Online", "value": "sonar-small-online" },
              { "label": "Sonar Medium Online", "value": "sonar-medium-online" },
              { "label": "CodeLlama 70B Instruct", "value": "codellama-70b-instruct" },
              { "label": "Llama 3 Sonar Large", "value": "llama-3-sonar-large-32k-online" }
            ],
            "index": 3,
            "sensitive": false
          },
          "pattern": "",
          "description": "Select a Perplexity AI model.",
          "title": "Models",
          "type": "string",
          "enum": [
            "mistral-7b-instruct",
            "mixtral-8x7b-instruct",
            "sonar-small-chat",
            "sonar-medium-chat",
            "sonar-small-online",
            "sonar-medium-online",
            "codellama-70b-instruct",
            "llama-3-sonar-large-32k-online"
          ]
        },
        "systemPrompt": {
          "buildship": { "index": 1, "sensitive": false },
          "pattern": "",
          "description": "The system's prompt message.\n\n**SAMPLE INPUT:**\n```\nBe precise and concise.\n```",
          "title": "System Prompt",
          "type": "string"
        },
        "apiKey": {
          "buildship": { "index": 0, "sensitive": false },
          "pattern": "",
          "description": "Perplexity AI API Key. Generate an API key through the [Perplexity Account Settings Page](https://www.perplexity.ai/settings).",
          "type": "string",
          "title": "API Key"
        },
        "userPrompt": {
          "buildship": { "index": 2, "sensitive": false },
          "pattern": "",
          "description": "The user's prompt question\n\n**SAMPLE INPUT:**\n```\nHow many stars are there in our galaxy?\n```",
          "title": "User Prompt",
          "type": "string"
        }
      },
      "required": ["apiKey", "systemPrompt", "userPrompt", "models"]
    },
    "version": "1.1.1",
    "script": "export default async function perplexityAIChatModel({\n    apiKey,\n    systemPrompt,\n    userPrompt,\n    models\n}: NodeInputs, { logging }) : NodeOutput  {\n    const response = await fetch('https://api.perplexity.ai/chat/completions', {\n        method: 'POST',\n        headers: {\n            'accept': 'application/json',\n            'authorization': `Bearer ${apiKey}`,\n            'content-type': 'application/json'\n        },\n        body: JSON.stringify({\n            model: models,\n            messages: [{\n                role: 'system',\n                content: systemPrompt\n            }, {\n                role: 'user',\n                content: userPrompt\n            }]\n        })\n    });\n  const responseJson = await response.json();\n  logging.log(response.status)\n  const resp = responseJson.choices?.[0].message.content;\n  return JSON.parse(resp)\n}",
    "failCount": 59,
    "deployedAt": { "_seconds": 1717467670, "_nanoseconds": 64000000 },
    "usageCounter": 296
  }
]
